<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Learn about the Physics and Maths behind Harmonic Oscillator, including Simple Harmonic Motion, undamped and damped oscillation, undriven and driven oscillation.">
    <title>Harmonic Oscillator: Explanation</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/png" href="../favicon.ico">
	<link rel="stylesheet" type="text/css" media="screen" href="../stylesheets/explanation.css">

    <!-- Load KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css" integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js" integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body)"></script>

    <script defer src="../libraries/inlineKatex.js" type="module"></script> <!-- load inline math --> 
</head>
<body>
	<header>
		<h1>Harmonic Oscillator</h1>
		<p>To view the demo, please visit the following links:</p>
		<ul>
			<li><b>Simple pendulum:</b> click <a href="../pendulum">here</a></li>
			<li><b>Harmonic oscillator solution graph:</b> click <a href=".">here</a></li>
		</ul>
		<p>To download this note, you can print this web page as PDF. Layout should work correctly.</p>
		<br>
		<h2>Table of contents</h2>
		<ul>
			<li><a href="#shm">Simple Harmonic Motion - Free oscillation</a></li>
			<li><a href="#damped">Damped oscillation</a></li>
			<li><a href="#driven">Driven oscillation</a></li>
		</ul>
	</header>
	<section id="shm">
		<h1>1. Simple Harmonic Motion (SHM) - Free oscillation</h1>
		<section>
			<h2>1.1. Introduction</h2>
			<p>Simple Harmonic Motion is characterised by the following equation:</p>
			$$\frac{d^2x}{dt^2} = - \omega ^2 x$$
		
			<p>There are some interesting properties of the above equation:</p>
			<ul>
				<li><b>Second order ODE:</b> This implies that the full solution requires at least 2 adjustable constants (or parameters).</li>
				<li><b>The equation is real:</b> $x$ is a real physical quantity (usually position), thus we should solve this equation in real domain $\mathbb{R}$.</li>
				<li><b>Linearity:</b> If $x_1(t)$ and $x_2(t)$ are two distinct solutions, $A_1x_1(t) + A_2x_2(t)$ is also a solution. This is also known as <em>superposition</em>.</li>
			</ul>
			
			<p>The full solution to this differential equation is: </p>
				$$x(t) = A \cos(\omega t + \beta)$$
				$$x(t) = A \cos \omega t + B \sin \omega t$$
		
			<p>where $A$, $B$ and $\beta$ are real constants.</p>
		</section>
		
		<section>
			<h2>1.2. Energy consideration</h2>
			<p>Total energy of an oscillating system usually exists in two forms: potential energy, a function of position, and kinetic energy, a function of velocity. If we consider a mass-spring system, potential energy and kinetic energy can be expressed as the following:</p>
			$$V(x) = \frac{1}{2}kx^2 = \frac{1}{2}k A^2 \cos^2 \omega t$$
			$$T(v) = \frac{1}{2}mv^2 = \frac{1}{2}m \omega ^2 A^2 \sin^2 \omega t$$
	
			<p>Total energy of the system: $E(x,v) = kA^2$. Energy is conserved, as expected. And this total energy is equal to maximum kinetic energy and maximum potential energy.</p>
			<p><b>NOTE:</b> $m\omega^2 = k$</p>
	
			<p>The oscillating system can be viewed as exchanging potential and kinetic energy periodically, via a force derived from a conservative field. In the case of mass-spring system, kinetic energy is from the moving mass (spring is considered massless, so it doesn't have kineic energy), potential energy is stored in the spring (elastic potential energy) and the force is the spring force.</p>
		</section>
	
		<section>
			<h2>1.3. Why study SHM?</h2>
			<p>Any system carrying out small oscillation around an equilibrium position is said to be in SHM. This can be shown by considering an arbitrary one dimensional potential, which is a function of position $V(x)$.</p>
			<img src="./assets/potential.png" class="illustration">
	
			<p>Suppose the function is convex at a particular poitn $x=a$. By evaluating the Taylor series of $V(x)$ at $x=a$ we obtain:</p>
			$$V(x) = V(a) + \frac{1}{1!} \frac{d}{dx} V(a) . (x-a) + \frac{1}{2!} \frac{d^2}{dx^2} V(a) . (x-a)^2 + ...$$
	
			<p>When the oscillation about $x=a$ is small, higher order of $(x-a)^n$ is negligible. Also note that because $\frac{d}{dx}V(a) = 0$, we will have:</p>
			$$V(x) - V(a) = k(x-a)^2$$
			$$F(x) = -\frac{dV}{dx} = -2k(x-a)$$
			$$\frac{d^2x}{dt^2} = -\frac{2k}{m} (x-a)$$
	
			<p>If we choose $(a,0)$ as the new origin, $(x-a)$ will become $x$ while the second time derivative of $x$ stays the same.</p>
			$$\frac{d^2x}{dt^2} = -\frac{2k}{m} x$$
			<p>which is the equation of motion for SHM.</p>
			<p>NOTE: see <a href="./taylor-series/explanation.html">Taylor series</a> for a more detailed explanation about the Taylor series.</p>
		</section>
	
		<section>
			<h2>1.4. Some typical oscillating systems</h2>
			<h3>Mass-spring</h3>
			<p>A mass $m$ is attached to a massless spring with a spring constant $k$. The spring obeys Hooke's Law in both extension and contraction.</p>
			<img class="illustration" src="./assets/mass_spring.png">
	
			<h3>Pendulum</h3>
			<p>To view a demonstration for a simple pendulum system, please visit <a href="../pendulum">here</a>.</p>
			<p>A point mass $m$ is attached to one end of an massless, inelastic string (or a solid rod) of lenght $L$. The mass is displaced and released from rest from a certain height.</p>
			<img class="illustration" src="./assets/pendulum.png">
	
			<h3>Floating object</h3>
			<p>A cylinder of diamter $d$ floats with $l$ of its length submerged. The total height is $L$. The cylinder is pushed down by a distance of $A$ and released.</p>
			<img class="illustration" src="./assets/floating_object.png">
	
			<h3>Spring of air</h3>
			<p>A vertical tube with a cross-sectional area of $A$ is filled with air of density $\rho$, under adiabatic condition (no heat transfer), is closed at one end and fitted with a freely-moving piston of mass $m$. The piston is pushed down and released.</p>
			<p>NOTE: under adiabatic condition, the first law of thermodynamics shows that:</p>
			$$dU = -PdV$$
			<img class="illustration" src="./assets/spring_of_air.png">
	
			<h3>LC circuit</h3>
			<p>An LC circuit is composed of an ideal capacitor with capacitance $C$ and an ideal inductor with inductance $L$. The two components are connected to each other (shown below). The capacitor is initially charged to a voltage $V_0$. Find the current in the circuit as a function of time.</p>
			<img class="illustration" src="./assets/LC_circuit2.png">
		</section>
	</section>
	

<!--
\section{Problems}

\begin{enumerate}
	\item \textbf{Sphere in a sphere} A solid sphere with radius $r$ and mass $m$ rotates inside a hollow sphere of radius $R$ as shown below. The solid sphere rolls without slipping. Calculate the period of small oscillations about the equilibrium. Moment of inertia of a sphere is $\frac{2}{5}mr^2$.
	
	\begin{figure}[!hbt]
		\centering
		\includegraphics[width=0.2\textheight]{sphere_in_sphere.png}
		\caption{\label{fig:sphere_in_sphere}Solid sphere rolls inside a hollow sphere}
	\end{figure}
	
	\item \textbf{Pendulum bob} A pendulum bob is constructed by taking a thin, uniform-density circular ring of mass $M$ and radius $R$ and affixing a straight, thin, uniform density rod of mass $m$ and length $2R$ across its diameter as shown in the diagram. The pendulum hangs in a vertical plane from a frictionless pivot that can be attached to the ring at any point. The pivot allows the bob to swing either in the plane of the bob or in the plane perpendicular to the bob. Assume the angular amplitude is small. Find the configurations that give maximum and minimum period.
	
	\begin{figure}[!hbt]
		\centering
		\includegraphics[width=0.14\textheight]{ring_and_rod.png}
		\caption{\label{fig:ring_and_rod}A pendulum bob.}
	\end{figure}
	
	\item \textbf{Hydrogen atom} An early but unfortunate incorrect model of the hydrogen atom suggested by J.J. Thomson postulated that the hydrogen atom is a positive cloud of charge $+e$ uniformly distributed throughout a volume of a sphere of radius $R$ with the elctron represented by an equal magnitude but negative point charge $-e$ at the centre of the sphere. Suppose the electron is displaced by a small distance. Find the frequency of the oscillation of the electron.
	
	\begin{figure}[!hbt]
		\centering
		\includegraphics[width=0.15\textheight]{electron.png}
		\caption{\label{fig:electron}A Hydrogen atom model.}
	\end{figure}

	\item \textbf{Binary system} Two stars, each of mass $M$ and separated by a distance $d$, orbit about their centre of mass. A planetoid of mass $m$ much smaller than $M$ moves along the axis of this system perpendicular to the orbital plane. Find the ratio of the period of the planetoid's oscillation to the orbital period of the stars.
	
	\begin{figure}[!hbt]
		\centering
		\includegraphics[width=0.17\textheight]{stars.png}
		\caption{\label{fig:stars}Binary stars system and a small mass.}
	\end{figure}
	
	\item \textbf{Particle in a bowl} A particle is constrained to move on the inner surface of a frictionless parabolic bowl whose cross-section has equation $z=kr^2$. The particle begins at the height $z_0$ above the bottom of the bowl with an initial velocity $v_0=0$. The acceleartion due to gravity is $g$. Find the period of oscillation for small $z_0$. Assume $z_0$ is not small, compare the actual period of motion and the SHM approximated period for small $z_0$.
	
	\begin{figure}[!hbt]
		\centering
		\includegraphics[width=0.28\textheight]{kx2.png}
		\caption{\label{fig:kx2}The bowl}
	\end{figure}

	\item \textbf{Water tube} A U-tube has vertical arms of radii $r$ and $2r$, connected by a horizontal tube of length $l$ whose radius increases linearly from $r$ to $2r$. The U-tube contains liquid up to a height $h$ in each arm. The liquid is set oscillating, and at a given instant the liquid in the narrower arm is a distance $y$ above the equilibrium level.
	
	\begin{figure}[!hbtt]
		\centering
		\includegraphics[width=0.4\textheight]{u_tube.png}
		\caption{\label{fig:u_tube}U-tube}
	\end{figure}
	
	(a) Show that the potential energy of the liquid is given by $U=\frac{5}{8}g\rho \pi r^2y^2$.
	
	(b) Show that the kinetic energy of a small slice of liquid in the horizontal arm (see the diagram) is given by
	$$dK=\frac{1}{2}\rho \frac{\pi r^2 dx}{(1+x/l)^2} \bigg(\frac{dy}{dt}\bigg)^2$$
	
	(c) Using the result of part (b), show that the total kinetic energy of all the moving liquid is given by
	$$K=\frac{1}{4}\rho \pi r^2\big(l+\frac{5}{2}h\big)\bigg(\frac{dy}{dt}\bigg)^2$$
	(Ignore any nastiness at the corners)
	
	(d) From (a) and (c), calculate period of oscillations if $l=5h/2$
	
	\item \textbf{Lennard-Jonnes} A commonly used potential energy function to describe the interaction between two atoms is the Lennard-Jones potential. It is described by the equation below
	$$U=\epsilon\Bigg[\Big(\frac{r_0}{r}\Big)^{12}-2\Big(\frac{r_0}{r}\Big)^6\Bigg]$$
	\begin{figure}[!hbt]
		\centering
		\includegraphics[width=0.6\textheight]{Lennard-Jones.png}
		\caption{\label{fig:LJ}Lennard-Jones potential.}
	\end{figure}

	Assume an atom is trapped in this potential well. Find the period of small oscillation.

	\item \textbf{Particle in a box} The one-dimension time-independent Schrondinger equation writes

	$$\hat{H} \psi(x) = E \psi(x)$$

	$\hat{H}$ is the Hamiltonian operator, defined as $\hat{H} = -\dfrac{\hbar^2}{2m} \dfrac{d^2}{dx^2} + V(x)$. It is corresponding to the total energy in classical mechanics $\dfrac{p^2}{2m} + V(x)$.
	
	$E$ is the energy of the system. You can treat it as a constant.
	
	$\psi(x)$ is the (time-independent) wave function, defined in the real domain. The integration of its amplitude squared from $x=a$ to $x=a+\Delta a$ gives the probability of finding the particle from $x=a$ to $x=a+\Delta a$
	
	$$P(a \,\ \text{to} \,\ a+\Delta a) = \int_{a}^{a+\Delta a}\big| \psi(x) \big| ^2 dx$$

	Consider an infinite potential well $V(x)$ defined as following:

	
\[	V(x) = 
	\begin{cases}
		0 & \text{if } -\frac{a}{2} \leq x \leq \frac{a}{2}\\
		\infty & \text{otherwise}
	\end{cases}
\]

	It turns out that not any real and positive values of $E$ yields a solvable equation. You can assume that the wave equation $\psi(x)$ vanishes to zero outside the well, and the wave equation is continuous everywhere (there is no sudden jump). 

	By solving the time-independent Schrondinger equation above, and considering the boundary conditions, find the wave equation $\psi(x)$. Therefore, deduce the allowed values of $E$. These values of $E$ are called \textit{Eigenenergies}.
	
	\begin{figure}[!hbt]
		\centering
		\includegraphics[width=0.6\textheight]{infty_well.png}
		\caption{\label{fig:LJ}Infinite potential well.}
	\end{figure}

	\textit{Note:} You can read about Quantum harmonic oscillator if interested. It considers a parabolic potential $V(x) = \frac{1}{2} m \omega^2 x^2$, which is analogous to the spring potential in classical sense. 

\end{enumerate}

\vspace{2cm}

1. $\omega^2 = \frac{g(R-r)}{\frac{14}{5}R^2 - \frac{8}{5}Rr + \frac{4}{5} r^2}$
\\

2. $I_{max}=2MR^2+\frac{4}{3}mR^2 \,\ I_{min}=\frac{3}{2}MR^2+mR^2$
\\

3. $P=\frac{4 \sqrt{\pi^3 \epsilon_0 m R^3}}{e}$
\\

4. $1:1$
\\

5. $P=\frac{\sqrt{2}\pi}{\sqrt{gk}}$
\\

7. $P = 2\pi r_0 \frac{\sqrt{m}}{6 \sqrt{2\epsilon}}$
\\

8. $E_n = \frac{n^2 \pi^2 \hbar^2}{2ma^2}$
\\

Content from A.P. French Waves and Oscillations. Problems from A.P French and Physics Olympiad past year papers.
-->

	<section id="damped">
		<h1>2. Damped oscillation</h1>
		<section>
			<h2>2.1. Introduction</h2>
			<p>Real oscillating systems must dissipate energy and come to a stop. In many situations, the resistive force is proportional to the velocity of the oscillator. We will include a resistive term $F = -\gamma \frac{dx}{dt}$ in the equation of motion.</p>
			$$\frac{d^2x}{dt^2} = -\omega_0^2x - \gamma\frac{dx}{dt}$$
			<p>where $\gamma$ is a positive, real constant. It determines the strength the resistive force. $\omega_0$ is the natural frequency, the angular frequency of free oscillation.</p>
	
			<p>Let's again consider some of important features of this ODE:</p>
			<ul>
				<li><b>This is a second-order ODE</b> with a first order term $\frac{dx}{dt}$.</li>
				<li><b>The equation is real</b> $x(t) \in \mathbb{R}$.</li>
				<li><b>Linearity</b>: If we have two distinct solutions $x_1(t)$ and $x_2(t)$, we can construct the full solution $A_1x_1(t)+A_2x_2(t)$.</li>
			</ul>
		</section>
		
		<section>
			<h2>2.2. Solving the ODE</h2>
			<p>Although the equation is in real domain ($x(t) \in \mathbb{R}$), it turns out that it's much easier to solve the ODE if we do it in complex domain $\mathbb{C}$.</p>
			<p>This particular trick works because a complex function is a <em>linear combination</em> of a real part and an imaginary part. Since time is in the real domain ($t \in \mathbb{R}$), time derivative of a complex function will have a separate real and imaginary parts. To understand this idea, we can write a complex function of time as $z(t)=a(t)+b(t)i$. If we plug this into the above ODE:</p>
			$$\frac{d^2z}{dt^2} = -\omega_0^2z-\gamma\frac{dz}{dt}$$
			$$\frac{d^2a}{dt^2} + \frac{d^2b}{dt^2}i = -\omega_0^2a -\omega_0^2bi - \gamma\frac{da}{dt} -\gamma\frac{db}{dt}i$$
	
			<p>The above equation requires that the real parts equal to the real parts, and the imaginary parts equal to the imaginary parts. Note that the first and second time derivatives of $a(t)$ and $b(t)$ are real functions.</p>
			$$\frac{d^2a}{dt^2} = -\omega_0^2a-\gamma\frac{da}{dt}$$
			$$\frac{d^2b}{dt^2} = -\omega_0^2b-\gamma\frac{db}{dt}$$
	
			<p>This means that both $a(t)$ and $b(t)$ are <b>real</b> solutions to the original ODE i.e. $a(t)$ and $b(t)$ are what we obtain if we solve the ODE in the real domain. Thus, what we can do is that we can solve the damped oscillation ODE in the complex domain, and then obtain the real part of that complex solution to get our real solution.</p>
	
			<p>There are many tricks to solve this ODE, especially in the complex domain. We can try using an exponential function because its derivative has a similar form to itself. So I will let $x(t) = Ae^{Bt}$, where $A$ and $B$ are complex constants. Its first and second time derivatives will be:</p>
			$$\frac{dx}{dt} = BAe^{Bt}$$
			$$\frac{d^2x}{dt^2} = B^2Ae^{Bt}$$
	
			<p>Let's substitute these back into our original ODE and rearrang it:</p>
			$$B^2Ae^{Bt} = -\omega_0^2Ae^{Bt} - \gamma \frac{dx}{dt} = BAe^{Bt}$$
			$$B^2 = -\omega_0^2 - \gamma B$$
			$$B^2 + \gamma B + \omega_0^2 = 0$$
	
			<p>This is our familiar <b>quadratic equation</b>. Because $B$ is a complex number, we can always find the value of B from the above equation. Surprisingly, it also means that the value of $B$ depends entirely on <b>characteristic</b> of our damped oscillation system ($\omega_0$ and $\gamma$). Let's consider our discriminant $\Delta = \gamma^2 - 4\omega_0^2$</p>
	
			<h3><b>Case 1</b>: $\Delta=0$ (or $\frac{\gamma}{2} = \omega_0$) - <em>Critical damping</em></h3>
			$$B = -\gamma/2 = -\omega_0$$
	
			<p>Our $B$ value is a real number! Our $A$ value will be one adjustable constant for our general solution.</p>
			$$x(t) = Ae^{-\frac{\gamma}{2}t}$$
	
			<p>This is great! As $A$ is our adjustable constant, we can get a real solution by choosing a real value for $A$.</p>
			<p>You might note that we still need one more adjustable constant to obtain the general solution. Thus, we need another solution to the ODE. This solution is not intuitive to guess, but it is $x(t) = Ate^{Bt}$. Its first and second time derivatives will be:</p>
			$$\frac{dx}{dt} = Ae^{Bt} + BAte^{Bt} = (1+Bt)Ae^{Bt}$$
			$$\frac{d^2x}{dt^2} = BAe^{Bt} + (1+Bt)BAe^{Bt} = (2+Bt)BAe^{Bt}$$
	
			<p>Substituting these back into our ODE:</p>
			$$(2+Bt)BAe^{Bt} = -\omega_0^2 Ate^{Bt} - \gamma (1+Bt)Ae^{Bt}$$
			$$(2+Bt)B = -\omega_0^2 t - \gamma (1+Bt)$$
			$$2B+B^2t = -\omega_0^2 t - \gamma - \gamma B t$$
			$$(B^2 + \gamma B + \omega_0^2)t + (2B + \gamma) = 0$$
	
			<p>This looks interesting! There is a small observation we can make about this. The left-hand side of the above equation can be thought as a function of time. This function is always equal to zero, which means that all of its coefficients are zero.</p>
			$$B^2 + \gamma B + \omega_0^2 = 0$$
			$$2B + \gamma = 0$$
	
			<p>What a coincidence! This will give us the exact value of $B$ as the above case: $B = -\gamma/2$. Thus our second solution will $x(t) = Ate^{-\frac{\gamma}{2}t}$.</p>
			
			<p>The general solution will be the linear combination of two solutions above:</p>
			$$x(t) = (A_1+A_2t)e^{-\frac{\gamma}{2}t}$$
	
			<p>This situation is also known as <b>Critical damping</b>. The system decays exponentially without oscillation. The amount of damping is just right to stop oscillation.</p>

			<h3><b>Case 2</b>: $\Delta>0$ (or $\frac{\gamma}{2} > \omega_0$) - <em>Overdamping</em></h3>
			$$B = -\frac{-\gamma \pm \sqrt{\Delta}}{2} = -\frac{\gamma}{2} \pm \sqrt{\frac{\gamma^2}{4}-\omega_0^2}$$

			<p>Great! We have two values of $B$, which correspond to two solutions:</p>
			$$x(t) = Ae^{(-\gamma/2 + \sqrt{\gamma^2/4-\omega_0^2})t}$$
			$$x(t) = Ae^{(-\gamma/2 - \sqrt{\gamma^2/4-\omega_0^2})t}$$

			<p>The general solution will be the linear combination of the above two solutions:</p>
			$$x(t) = e^{-\frac{\gamma}{2} t} \bigg(A_1e^{\sqrt{\gamma^2/4-\omega_0^2}t}+A_2e^{-\sqrt{\gamma^2/4-\omega_0^2}t}\bigg)$$

			<p>Again, we can choose the values of $A_1$ and $A_2$ to be real to obtain the real solution.</p>
			
			<p>This situation is known as <b>overdamping</b>. The system decays slowlier than exponentially. The amount of damping is so great that it takes longer for the system to return to the equilibrium position.</p>

			<h3><b>Case 3</b>: $\Delta < 0$ (or $\frac{\gamma}{2} < \omega_0$) - <em>Underdamping</em></h3>
			$$B = -\frac{-\gamma \pm i\sqrt{-\Delta}}{2} = -\frac{\gamma}{2} \pm i\sqrt{\omega_0^2-\frac{\gamma^2}{4}}$$

			<p>Again, each value of $B$ corresponds to one solution:</p>
			$$x(t) = Ae^{(-\gamma/2 + i\sqrt{\omega_0^2-\gamma^2/4})t}$$
			$$x(t) = Ae^{(-\gamma/2 - i\sqrt{\omega_0^2-\gamma^2/4})t}$$

			<p>However, it must be noted that our values of $B$ are complex numbers, and unfortunately, we cannot ignore this fact. We have to take the real part of the above solutions. Luckily, the <a href="http://mathworld.wolfram.com/EulerFormula.html">Euler identity</a> allows us to write the above solutions in a clearer form, to see the real and imaginary parts.</p>
			$$x(t) = Ae^{-\frac{\gamma}{2} t} \Bigg[\cos\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg) + i\sin\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg)\Bigg]$$
			$$x(t) = Ae^{-\frac{\gamma}{2} t} \Bigg[\cos\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg) - i\sin\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg)\Bigg]$$

			<p>The real part of the solution above will give us a real solution. Howver, both above solutions have the same real part, thus we will not get two distinct solutions by taking the real part of the two solutions. This is indeed very unfortunate. But interestingly, the imaginary part of the <em>complex</em> solution is also a <em>real</em> solution.</p>

			<p>Taking the imaginary part alone (without the imaginary unit $i$) will give us another real solution. Therefore, our two real distinct solutions are:</p>
			$$x(t) = Ae^{-\frac{\gamma}{2} t} \cos\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg)$$
			$$x(t) = Ae^{-\frac{\gamma}{2} t} \sin\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg)$$

			<p>The general solution will be a linear combination of the above solutions:</p>
			$$x(t) = e^{-\frac{\gamma}{2} t} \Bigg[A_1 \cos\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg) + A_2 \sin\bigg(\sqrt{\omega_0^2-\frac{\gamma^2}{4}}t\bigg)\Bigg]$$

			<p>The general solution shows that this is an oscillating system from the term $\cos$ and $\sin$. Thus, the quantity $\sqrt{\omega_0^2-\frac{\gamma^2}{4}}$ is the <b>angular frequency</b> of oscillation. With this information, we can then set $\omega = \sqrt{\omega_0^2-\frac{\gamma^2}{4}}$ and simplify our general solution:</p>
			$$x(t) = e^{-\frac{\gamma}{2} t} \bigg(A_1 \cos \omega t + A_2 \sin \omega t \bigg)$$

			<p>We can make an interesting observation here. Using the <a href="http://mathworld.wolfram.com/SchwarzsInequality.html">Cauchy–Schwarz inequality</a>, we get this:</p>
			$$A_1 \cos \omega t + A_2 \sin \omega t \leq \sqrt{A_1^2+A_2^2} \sqrt{\cos^2 \omega t + \sin^2 \omega t} = \sqrt{A_1^2+A_2^2}$$
			<p>Note that $\cos^2{\theta} + \sin^2{\theta} = 1$ for any real values of $\theta$. Thus:</p>
			$$x(t) \leq \sqrt{A_1^2+A_2^2} e^{-\frac{\gamma}{2}}$$

			<p>The above inequality means that our general solution is always smaller than an exponential function. This exponential function $\sqrt{A_1^2+A_2^2} e^{-\frac{\gamma}{2}}$ is known as the <b>envelope</b> of our solution: the system will oscillate within this exponential decay envelope.</p>
			
			<p>This is the most interesting situation, also known as <b>underdamping</b>. The <b>amplitude</b> of oscillation decays exponentially with time until there is no more oscillation. The system oscillates at an angular frequency slightly below its <b>natural frequency</b>. The amount of damping is small, dissipating the energy of oscillation.</p>

			<p>Note that our general solution can be written in a more compact form:</p>
			$$x(t) = Ae^{-\frac{\gamma}{2} t}\cos (\omega t+\phi)$$

			<p>At this point, it's best to visit the <a href="./" target="__blank">Harmonic Oscillator solution graph</a> to understand the behavior of the system when the value of $\gamma$ changes. Keep in mind that you should set the value of $F_0$ to zero.</p>
		</section>
	</section>

	<section id="driven">
		<h1>3. Driven oscillation without damping</h1>
		<section>
			<h2>3.1. Introduction</h2>
			<p>All of the situations above do not involve an external driving force. Suppose we want to use a force to drive the oscillator. There are many forms that our driving force can take, but for simplicity, we will take the driving force to be of the form $F(t)=F_0 \cos \omega_d t$, where $\omega_d$ is the angular frequency of the driving force. This force is an oscillating force, a worthy assumption for our oscillating system. The ODE then becomes:</p>
			$$\frac{d^2x}{dt^2}=-\omega_0^2x+\frac{F_0}{m}\cos \omega_d t$$

			<p>Let's make some observations about this ODE:</p>
			<ul>
				<li>This is a <b>non-linear</b> ODE: a linear combination of two distinct solutions does not give us another solution.</li>
			</ul>

			<p>This fact will be an obstacle for us, but there is a little trick to circumvent this. I will discuss it later.</p>
		</section>

		<section>
			<h2>3.2. Solving the ODE</h2>
			<h3>3.2.1. Steady-state solution</h3>
			<p>Although this ODE is in the real domain, again, it's much easier to analyse and solve it in the complex domain. Remember, our real solution is the real part of our complex solution. Thus, instead of considering our driving force as $F(t) = F_0 \cos \omega_d t$, we will consider our driving force as a complex exponential function of time $F(t) = F_0 e^{i\omega_d t}$. We can do this thanks to the <a href="http://mathworld.wolfram.com/EulerFormula.html">Euler identity</a>. Our ODE in the complex domain will be:</p>
			$$\frac{d^2x}{dt^2}=-\omega_0^2x+\frac{F_0}{m}e^{i\omega_d t}$$

			<p>We will guess our solution to be an exponential function again. However, as you might have observed, we have the driving force term, which has its own exponential term. Thus, we can try an exponential function with the same power as the driving force term as our solution. In the Physics sense, we can understand that our oscillating system follows the angular frequency of the driving force.</p>
			$$x=Ae^{i \omega_d t}$$
			$$\frac{dx}{dt}=i\omega_dAe^{i \omega_d t}$$
			$$\frac{d^2x}{dt^2}=-\omega_d^2Ae^{i \omega_d t}$$

			<p>Substituting these into our ODE:</p>
			$$-\omega_d^2Ae^{i \omega_d t}=-\omega_0^2Ae^{i \omega_d t}+\frac{F_0}{m}e^{i\omega_d t}$$
			$$-\omega_d^2A=-\omega_0^2A+\frac{F_0}{m}$$
			$$(\omega_0^2-\omega_d^2)A=\frac{F_0}{m}$$
			$$A = \frac{F_0/m}{\omega_0^2-\omega_d^2}$$

			<p>This is indeed very strange! Remember from the above situations, the $A$ value will be one of our adjustable constants. But in this case, we get an <em>exact</em> and <em>real</em> value of $A$! Although we are happy that the complex solution $x(t)=Ae^{i\omega_d t}$ works, this is a <b>fixed</b> solution: we cannot modify this solution to fit to our initial conditions.</p>
			<p>At least we know that the corresponding real solution will simply be:</p>
			$$x(t) = A\cos \omega_d t$$
			<p>where $A = \frac{F_0/m}{\omega_0^2-\omega_d^2}$.</p>

			<p>This particular solution has a special name: the <b>steady-state solution</b>. This solution is the dominant behavior of the oscillating system after a long period time, when the initial conditions no longer matter much. To fully understand this concept, please continue reading.</p>

			<h3>3.2.2. Transient solution</h3>
			<p>We will use a clever trick here. Note that our ODE has an extra driving force term. This term prevents us from adding two solutions together to obtain another solution. However, if we add a solution of <b>free oscillation</b> ODE to a solution of driven oscillation ODE, the newly obtained solution will not affect the driving force term. To see this more clearly, consider $x_1(t)$ as a solution to free oscillation ODE and $x_2(t)$ as a solution to driven oscillation ODE:</p>
			$$\frac{d^2x_1}{dt^2} = -\omega_0^2 x_1$$
			$$\frac{d^2x_2}{dt^2} = -\omega_0^2 x_2 + \frac{F_0}{m}\cos \omega_d t$$
			$$\frac{d^2(x_1+x_2)}{dt^2} = -\omega_0^2 (x_1+x_2) + \frac{F_0}{m}\cos \omega_d t$$

			<p>Wow! $x_1(t)+x_2(t)$ is a solution to the driven oscillation ODE! Recall the solution to the free oscillation ODE is $x_1(t)=A\cos(\omega t+\phi)$, our general solution to the driven oscillation ODE is:</p>
			$$x(t) = A\cos(\omega t+\phi) + \frac{F_0/m}{\omega_0^2-\omega_d^2}\cos \omega_d t$$
			<p>where $A$ and $\phi$ are our two adjustable constants.</p>

			<p>However there is a problem to this solution. This is a sum of two cosine terms with different angular frequencies, which will produce a <b>beat</b> pattern. Visit <a href="./" target="__blank">Harmonic Oscillator solution graph</a> and set $\gamma$ to zero to observe this phenomenon.</p>
		</section>

		<section>
			<h2>3.3. Resonance</h2>
			<p>Taking a closer look at our steady state solution:</p>
			$$x(t) = \frac{F_0/m}{\omega_0^2-\omega_d^2}\cos \omega_d t$$

			<p>The amplitude of this oscillation depends on the magnitude of the driving force $F_0$, the angular frequency of the driving force $\omega_d$ and the natural frequency of the oscillating system $\omega_0$.</p>
		</section>
	</section>

	<section>
		<h1>4. Driven oscillation with damping</h1>
		<section>
			<h2>4.1. Introduction</h2>
		</section>

		<section>
			<h2>4.2. Solving the ODE</h2>
		</section>

		<section>
			<h2>4.3. The transient and steady-state solutions</h2>
		</section>

		<section>
			<h2>4.4. The frequency response graph and Resonance</h2>
		</section>
	</section>

	<section>
		<h1>5. Interesting examples of harmonic oscillators</h1>
	</section>

We guess a solution to be an exponential of $i\omega t$ in the form $x=Ae^{i \omega t}$. The rationale behind this is that we can cancel out the term $e^{i \omega t}$ in the equation. (Note that $A$ is a complex number)

$$-\omega^2Ae^{i \omega t}=-\omega_0^2Ae^{i \omega t}+\frac{F_0}{m}e^{i\omega t}$$
$$(\omega_0^2-\omega^2)A=F_0/m$$
$$A = \frac{F_0/m}{\omega_0^2-\omega^2}$$

We have established that $A$ is a complex number. We will interpret the magnitude of $A$ ($|A|$) as the amplitude of oscillation, and phase angle, or argument, of $A$ ($\arg(A)$) as the phase lag of oscillation behind the driving force. 
\\

We will plot a graph called \textbf{Frequency response} of the oscillator. It plots amplitude $|A|$ and phase lag $\arg(A)$ against the driving frequency $\omega$. The graph shows how the oscillator responds to different frequencies of the driving force, hence the name \textit{Frequency response}.

\begin{figure}[!hbt]
	\centering
	\includegraphics[width=0.55\textheight]{freq_resp_no_damp.png}
	\caption{\label{fig:driven_osc}Frequency response graph.}
\end{figure}

At $\omega = \omega_0$, \textbf{resonance} ocurred, where the amplitude approaches infinity. When $\omega < \omega_0$, the oscillator is in phase with the driving force. When $\omega > \omega_0$, the oscillator is lagging behind the driving force by a phase of $\pi$.
\\

We have obtained the solution $x_1 = Ae^{i\omega t}$ where $A = \dfrac{F_0/m}{\omega_0^2-\omega^2}$. The full complex and real solution of driven oscillation without damping:

$$x = \dfrac{F_0/m}{\omega_0^2-\omega^2}e^{i\omega t} + Ae^{i\omega_0t} + Be^{-i\omega_0t}$$
$$x = C \cos (\omega t -\delta) + A\cos\omega_0t + B\sin\omega_0t$$
\\

where $C = \Bigg| \dfrac{F_0/m}{\omega_0^2-\omega^2} \Bigg|$ and $\delta = 0$ when $\omega < \omega_0$ or $\delta = \pi$ when $\omega < \omega_0$.

\subsection{Energy consideration}

By considering the steady-state solution (go to Section 4 to read more about steady-state), it can be shown that the rate of work done by the driving force is a sinusoid. There is no net work done by the driving force on the system.

\section{Driven oscillation with damping}

Let's consider an oscillator being driven by an external force in the presence of damping.

$$\frac{d^2x}{dt^2}=-\omega_0^2 x - \gamma \frac{dx}{dt} + \frac{F_0}{m}\cos \omega t$$

Using similar argument, we know that the full solution to this ODE is $x_1+x_0$, where $x_0$ is the full solution to free oscillation with damping. We only need to find $x_1$.

Solving the equation in complex domain, we propose a solution $x=Ae^{i\omega t}$.

$$\frac{d^2x}{dt^2}=-\omega_0^2 x - \gamma \frac{dx}{dt} + \frac{F_0}{m}e^{i\omega t}$$

$$-\omega^2 Ae^{i\omega t} = -\omega_0^2 Ae^{i\omega t} - \gamma \omega i Ae^{i\omega t} + \frac{F_0}{m} e^{i\omega t}$$
$$(\omega_0^2-\omega^2 + \gamma \omega i)A = \frac{F_0}{m}$$ 
$$A = \frac{F_0/m}{\omega_0^2-\omega^2+\gamma \omega i}$$

To obtain amplitude and phase lag of the oscillator, we calculate the magnitude and argument (phase angle) of $A$. Note that $A$ is in either third or fourth quadrant on Argand diagram, so its argument is negative. However phase lag is positive, thus we take phase lag to be $-\arg(A)$.

$$C = |A| = \frac{F_0/m}{\sqrt{(\omega_0^2-\omega^2)^2+\gamma^2 \omega^2}}$$
$$\delta = -\arg(A) = \arctan \big(-\frac{\gamma \omega}{\omega_0^2-\omega^2}\big)$$

\begin{figure}[!hbt]
	\centering
	\includegraphics[width=0.6\textheight]{freq_resp_damp.png}
	\caption{\label{fig:driven_osc}Frequency response graph.}
\end{figure}

Maximum amplitude occurs when driving frequency is slightly lower than $\omega_0$. However, for convenience, we still say that resonance occurs when $\omega = \omega_0$. At resonance, there is a large, but finite, response. The larger the damping coefficient $\gamma$, the less responsive the oscillator is to the driving force.

The full complex solution to driven oscillation with damping:

$$x = \frac{F_0/m}{\omega_0^2-\omega^2+\gamma \omega i} e^{i\omega t} + x_0$$

 $x_0$ will take the form of underdamped, critically damped or overdamped oscillation depending on damping coefficient $\gamma$. The two adjustable constants thus come from $x_0$. If we convert the solution to real domain:

$$x = C\cos(\omega t - \delta) + x_0$$

where $C$ and $\delta$ are amplitude and phase lag.

\subsection{Energy consideration}

Again, by considering the steady-state solution, you can obtain an expression for the rate of work done by the driving force as a function of time. If you average are to average the power over one period, you can show that the net power is constant. This implies that there is energy input from the external force, and this energy is equal to the energy lost by the resistive force.

\section{Transient and Steady-state of driven oscillation}

When an external force is trying to drive the system, the system has a tendency to resist this change, called \textit{transient} effect. Transient response is represented by the free oscillation (with or without damping) part of the solution. The type of transient is thus characterised by the type of free oscillation that it would carry out. People often use the quantity $Q=\frac{\omega_0}{\gamma}$, called \textit{Quality factor}, to determine the type of transient.
\\

Steady-state is when the system enters a stable phase, which is described by a sinusoid $x_1 = A\cos(\omega t - \delta)$. For driven oscillation with damping, the oscillator will reach steady-state after some time as the transient effect decays exponentially with time. For driven oscillation without damping, the oscillator will generally do not reach steady-state because the transient effect does not decay with time.
\\

Driven oscillation with damping: $x = A \cos (\omega t - \delta) + x_1 e^{-\frac{\gamma}{2}t}$
\\

Driven oscillation without damping: $x = A \cos (\omega t - \delta) + A \cos (\omega t + \beta)$

\section{Example: AC circuit}
In AC circuit analysis, impedance is equivalent to resistance in DC circuit. 

$$Z = \frac{V(t)}{i(t)}$$

Impedance is a complex number. In AC, $V(t)$ and $i(t)$ are sinusoids. The magnitude of impedance is the ratio of magnitude of voltage and current, while the argument of impedance is the phase difference between voltage and current.

$$Z = R+jX$$

The real part $R$ is called resistance, while the imaginary part $X$ is called reactance. Impedance is useful because it helps people use DC formulas in AC circuit (electrical components in series, parallel, potential divider...). \textit{Note:} frequency in this context is used interchangeably with angular frequency.

\begin{enumerate}
	\item \textbf{Impedance} We will treat voltage source as a driver $V=V_0 \cos \omega t$ and current as an oscillator $i(t)=i_0 \cos (\omega t - \delta)$. By considering a capacitor and an inductor separately, solve for their steady-state solutions, and derive their impedance.

	\item \textbf{Driven RLC circuit} Consider a RLC circuit (a resistor R, an inductor L and a capacitor C in series connected to an AC power source). Find the resonance frequency $\omega_0$, damping factor $\gamma$ and quality factor $Q$ of the circuit in terms of $R,L,C$. Find the steady-state current $i(t)$ at resonance, and thus calculate the average rate of heat lost $\langle P \rangle$ by the resistor.

	\item \textbf{Transient effect} Estimate the time when the RLC system reaches steady-state for $R=1\text{k}\Omega, L=10\mu \text{H}, C = 100\text{nF}$.

	\item \textbf{High-pass, low-pass filter} A low-pass filter is a circuit that reduces amplitude of high frequency signal, allowing only low frequency signal to pass through. A high-pass filter works the opposite, allowing high frequency signal to pass through but not low frequency one. Low-pass filter is usually used to remove unwanted high-frequency noise in the signal. High-pass filter can be used to remove DC signal ($\omega = 0$).

	Using only resistor, capacitor and inductor, design low-pass and high-pass circuit
	
	\textit{Hint:} Use potential divider formula to find output voltage as a function of input voltage frequency. 

	\item \textbf{Cut-off frequency and band-pass, band-stop filter} Cut-off frequency is defined as the frequency at which the response is $\frac{1}{\sqrt{2}}$ or $0.707$. Band-pass and band-stop filters are combinations of low-pass and high-pass filter. Band-pass filter allows signal with frequencies within a frequency range, while band-stop filter blocks signal with frequencies within a frequency range.
	
	Find cut-off frequency of your designed circuits above and design a band-pass filter that allows frequencies from $\omega_1$ to $\omega_2$. \textit{Fact:} the difference between $\omega_1$ and $\omega_2$ in this case is called bandwidth.

\end{enumerate}

\textbf{Fun Facts} Consider an arbitrary, real and periodic signal $S(t)$ of period $P$. By Fourier's theorem, we can decompose the signal into linear combination of sinusoids.

$$S(t) = a_0 + a_1 \cos \omega_1 t + a_2 \cos \omega_2 t + \dots + b_1 \sin \omega_1 t + b_2 \sin \omega_2 t + \dots$$
$$S(t) = a_0 + \sum_{i=1}^\infty a_i \cos \omega_i t + \sum_{i=1}^\infty b_i \sin \omega_i t$$

where $\omega_1 = \frac{2\pi}{P}$ and $\omega_n = n\omega_1$. $\omega_1$ is called \textit{fundamental frequency}. $\omega_n$ are overtones, or \textit{harmonics}. $a_0$ is called the \textit{bias}, or DC, signal. If we use this signal as the driver term:

$$\frac{d^2x}{dt^2}=-\omega_0^2 x - \gamma \frac{dx}{dt} + S(t)$$

Consider the following ODEs:

$$\frac{d^2x}{dt^2}=-\omega_0^2 x - \gamma \frac{dx}{dt} + a_0$$
$$\frac{d^2x}{dt^2}=-\omega_0^2 x - \gamma \frac{dx}{dt} + a_1 \cos \omega_1 t$$
$$\frac{d^2x}{dt^2}=-\omega_0^2 x - \gamma \frac{dx}{dt} + b_1 \sin \omega_1 t$$

We soon realize the full solution to the ODE with the original signal is:

$$x = x_{a_0} + x_{a_1} + x_{a_2} + \dots + x_{b_1} + x_{b_2} + \dots = x_{a_0} + \sum_{i=1}^\infty x_{a_i} + x_{b_i}$$

where $x_{a_0}$ is the solution to the equation with bias term, $x_{a_i}$ and $x_{b_i}$ is the solution to the equation with cosine and sine term respectively. Thus, by understanding how the oscillator behaves in response to a sinusoidal driver, we can extend the theory to an arbitrary periodic driver. Note that it is possible to extend the analysis to non-periodic signal.
\\

	<footer>
		Reference: A.P. French Waves and Oscillations
	</footer>
</body>
</html>